<!--
    TODO : remove the 'approved' class by default (it's just to show what it does, here).
    Add it only on questions which have been evaluated as 'improvable' or 'acceptable'.
    In addition of this class, questions should be 'locked' (uneditable).
    However, other questions ('to be fixed') don't get this special class and stay editable.
-->
<div *ngFor="let question of questions" class="pia-questionBlock approved" [attr.data-id]="question.id">
  <div class="pia-questionBlock-title">
    <button class="btn" type="button" (click)="displayQuestion()" title="Afficher / masquer"><span class="pia-icons pia-icon-accordeon-up"></span></button>
    {{question.title}}
  </div>
  <div class="pia-questionBlock-displayer fadeIn">
    <button type="button" class="btn pia-questionBlock-edit hide" (click)="activateQuestionEdition()" title="Éditer"><i class="fa fa-pencil" aria-hidden="true"></i></button>
    <form [formGroup]="questionForm">

      <!-- TODO : to display only if question is of type 'gauge' -->
      <div class="pia-gaugeBlock" *ngIf="question.answer_type == 'gauge'">
        <input type="range" value="33" min="0" max="100" step="33">
        <span>Négligeable</span><span>Limité</span><span>Importante</span><span>Maximale</span>
        <div class="pia-gaugeBlock-background" style="width:35.5%;"></div>
      </div>

      <div class="pia-questionBlock-content">
        <!-- TODO : check the question.type (text or list here) to display a question with tags or a simple question -->
        <tag-input
          *ngIf="question.answer_type == 'list'"
          (onAdd)="onAdd($event)"
          (onTagEdited)="onTagEdited($event)"
          (onRemove)="onRemove($event)"
          formControlName="questionTags"
          [theme]="'foundation-theme'"
          [ngModel]="tags"
          [placeholder]="'&#10010;'"
          [editable]="'true'"
          [secondaryPlaceholder]="'Entrez votre source  &#10010;'">
          <tag-input-dropdown
            [showDropdownIfEmpty]="true"
            [autocompleteItems]="userMeasures">
          </tag-input-dropdown>
        </tag-input>
        <textarea
          *ngIf="question.answer_type == 'text' || question.answer_type == 'gauge'"
          [attr.data-id]="question.id"
          id="pia-question-content-{{question.id}}"
          formControlName="questionContent"
          name="pia-question"
          rows="8"
          cols="50"
          (focusout)="questionContentFocusOut()"
          placeholder="{{question.placeholder}}">
        </textarea>
      </div>
    </form>
  </div>

  <!-- TODO : to show only after a first edition (when the current question is created in DB) -->
  <app-comments [pia]="pia" [question]="question"></app-comments>

  <!-- TODO : to show only on evaluation mode -->
  <app-evaluations *ngIf="item.evaluation_mode == 'question'" [item]="item"></app-evaluations>
</div>
